<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Admin panel</title>
    <style>body{font-family: system-ui, sans-serif; padding:20px;} textarea{width:100%;height:120px}</style>
  </head>
  <body>
    <h1>Admin</h1>
    <p>Токен: <code>{{ token }}</code></p>

    <h2>Агенты</h2>
    <table border="1" cellpadding="6">
      <tr><th>id</th><th>hostname</th><th>last_seen</th><th>info</th></tr>
      {% for a in agents %}
      <tr><td>{{ a.id }}</td><td>{{ a.hostname }}</td><td>{{ a.last_seen }}</td><td><pre>{{ a.info }}</pre></td></tr>
      {% endfor %}
    </table>

    <h2>Создать задачу</h2>
    <form action="/admin/create_task?token={{ token }}" method="post">
      <label>Название: <input name="name"></label><br><br>
      <label>Целевой агент (оставьте пустым — всем): <input name="target_agent"></label><br><br>
      <label>Скрипт (bash):</label><br>
      <textarea name="script"></textarea><br>
      <button type="submit">Отправить</button>
    </form>

    <h2>Задачи</h2>
    <table border="1" cellpadding="6">
      <tr><th>id</th><th>name</th><th>target</th><th>status</th><th>result</th></tr>
      {% for t in tasks %}
      <tr>
        <td>{{ t.id }}</td>
        <td>{{ t.name }}</td>
        <td>{{ t.target_agent }}</td>
        <td>{{ t.status }}</td>
        <td><pre>{{ t.result }}</pre></td>
      </tr>
      {% endfor %}
    </table>
  </body>
</html>
